[supervisord]
nodaemon=true
logfile=/app/logs/supervisord.log
childlogdir=/app/logs/

[program:xvfb]
command=/usr/bin/Xvfb :99 -screen 0 1920x1080x24 -ac +extension GLX +render -noreset
priority=100
autorestart=true
stdout_logfile=/app/logs/xvfb.log
stderr_logfile=/app/logs/xvfb.log

[program:fluxbox]
command=/usr/bin/fluxbox -display :99
priority=200
autorestart=true
environment=DISPLAY=":99"
stdout_logfile=/app/logs/fluxbox.log
stderr_logfile=/app/logs/fluxbox.log

[program:vnc]
command=/usr/bin/x11vnc -display :99 -nopw -listen localhost -xkb -ncache 10 -ncache_cr -forever
priority=300
autorestart=true
stdout_logfile=/app/logs/vnc.log
stderr_logfile=/app/logs/vnc.log

[program:novnc]
command=/usr/share/novnc/utils/novnc_proxy --vnc localhost:5900 --listen 6080
priority=400
autorestart=true
stdout_logfile=/app/logs/novnc.log
stderr_logfile=/app/logs/novnc.log

[program:adb-server]
command=/opt/adb-server/adb-setup.sh
priority=500
autorestart=true
stdout_logfile=/app/logs/adb.log
stderr_logfile=/app/logs/adb.log

[program:emulator]
command=/opt/android/emulator/emulator @test -no-audio -no-boot-anim -no-window -gpu swiftshader_indirect -camera-back webcam0 -camera-front webcam0 -skin 1080x1920
priority=600
autorestart=true
environment=DISPLAY=":99",ANDROID_HOME="/opt/android",ANDROID_SDK_ROOT="/opt/android"
stdout_logfile=/app/logs/emulator.log
stderr_logfile=/app/logs/emulator.log

[program:appium]
command=/usr/local/bin/appium --allow-insecure chromedriver_autodownload --relaxed-security --log-timestamp --log /app/logs/appium.log
priority=700
autorestart=true
stdout_logfile=/app/logs/appium.log
stderr_logfile=/app/logs/appium.log

[program:automation-api]
command=/opt/android-automation/bin/python /app/android-automation-server.py
priority=800
autorestart=true
stdout_logfile=/app/logs/automation-api.log
stderr_logfile=/app/logs/automation-api.log

[program:performance-monitor]
command=/opt/android-automation/bin/python /app/android-monitor.py
priority=900
autorestart=true
stdout_logfile=/app/logs/monitor.log
stderr_logfile=/app/logs/monitor.log